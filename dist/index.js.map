{"version":3,"file":"index.js","sources":["../src/deep-compare.js","../src/index.js"],"sourcesContent":["var pSlice = Array.prototype.slice;\nvar Object_keys =\n  typeof Object.keys === \"function\"\n    ? Object.keys\n    : function (obj) {\n      var keys = [];\n      for (var key in obj) keys.push(key);\n      return keys;\n    };\nvar deepEqual = function (actual, expected) {\n  // enforce Object.is +0 !== -0\n  if (actual === 0 && expected === 0) {\n    return areZerosEqual(actual, expected);\n\n    // 7.1. All identical values are equivalent, as determined by ===.\n  } else if (actual === expected) {\n    return true;\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n  } else if (isNumberNaN(actual)) {\n    return isNumberNaN(expected);\n\n    // 7.3. Other pairs that do not both pass typeof value == 'object',\n    // equivalence is determined by ==.\n  } else if (typeof actual != \"object\" && typeof expected != \"object\") {\n    return actual == expected;\n\n    // 7.4. For all other Object pairs, including Array objects, equivalence is\n    // determined by having the same number of owned properties (as verified\n    // with Object.prototype.hasOwnProperty.call), the same set of keys\n    // (although not necessarily the same order), equivalent values for every\n    // corresponding key, and an identical 'prototype' property. Note: this\n    // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected);\n  }\n};\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == \"[object Arguments]\";\n}\n\nfunction isNumberNaN(value) {\n  // NaN === NaN -> false\n  return typeof value == \"number\" && value !== value;\n}\n\nfunction areZerosEqual(zeroA, zeroB) {\n  // (1 / +0|0) -> Infinity, but (1 / -0) -> -Infinity and (Infinity !== -Infinity)\n  return 1 / zeroA === 1 / zeroB;\n}\n\nfunction objEquiv(a, b) {\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b)) return false;\n\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b);\n  }\n  try {\n    var ka = Object_keys(a),\n      kb = Object_keys(b),\n      key,\n      i;\n  } catch (e) {\n    //happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length) return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i]) return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key])) return false;\n  }\n  return true;\n}\n\nexport default deepEqual;\n","import React, { Component } from \"react\";\nimport {\n  Form,\n  Row,\n  Col,\n  Select,\n  Button,\n  Modal,\n  Tag,\n  Icon,\n  Input,\n  Table,\n  Divider,\n  message\n} from \"antd\";\nimport deepCompare from \"./deep-compare\";\n\nconst FormItem = Form.Item;\n\nexport default class extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      disabled: false,\n      skuPropsList: [],\n      skuPropVoList: [],\n      tmpSkuProps: [],\n      tmpSkuColumns: [],\n      skuTableColumns: [],\n      skuTableDataSource: [],\n\n      //\n      editProp: null\n    };\n  }\n\n  componentDidMount() {\n    const { disabled, skuPropsList, skuPropVoList } = this.props;\n    this.setState(\n      {\n        disabled,\n        skuPropVoList,\n        skuPropsList\n      },\n      () => {\n        this._initData();\n      }\n    );\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps, prevState) {\n    const { disabled, skuPropsList, skuPropVoList } = nextProps;\n    let update = {};\n    let needInit = false;\n\n    if (disabled !== this.state.disabled) {\n      update = Object.assign(update, { disabled });\n    }\n\n    if (!deepCompare(skuPropsList, this.state.skuPropsList)) {\n      update = Object.assign(update, { skuPropsList });\n    }\n\n    if (!deepCompare(skuPropVoList, this.state.skuPropVoList)) {\n      needInit = true;\n      update = Object.assign(update, { skuPropVoList });\n    }\n\n    this.setState(update, () => {\n      needInit && this._initData();\n    });\n  }\n\n  reset() {\n    this.setState({\n      tmpSkuProps: [],\n      tmpSkuColumns: [],\n      skuTableColumns: [],\n      skuTableDataSource: []\n    });\n  }\n\n  addOneProp() {\n    const { tmpSkuColumns, tmpSkuProps } = this.state;\n\n    let key = `key_${new Date().getTime()}`;\n    tmpSkuColumns.push({\n      title: \"\",\n      dataIndex: `validPropColumn_${tmpSkuColumns.length}`\n    });\n    tmpSkuProps.push({\n      key: key,\n      saveInputRef: React.createRef(),\n      tags: []\n    });\n\n    this.setState({\n      tmpSkuColumns,\n      tmpSkuProps\n    });\n  }\n\n  refreshSKUTable() {\n    const { extras = [], onChange = () => { }, filterSku = false } = this.props;\n    const { tmpSkuColumns, tmpSkuProps } = this.state;\n    let tagsOfValidProps = [],\n      validPropsCount = 0,\n      skuTableColumns = [],\n      skuTableRowCount = 0;\n\n    // 所有属性: 有tag的属性和无tag的属性\n    tmpSkuProps.forEach((sku, i) => {\n      let tags = sku.tags;\n      // 有tag的属性生成表头\n      if (tags.length > 0) {\n        // 记录表头\n        skuTableColumns.push(\n          Object.assign(tmpSkuColumns[i], {\n            dataIndex: `validPropColumn_${validPropsCount}`\n          })\n        );\n        // 记录有效的属性(有tag的)个数\n        validPropsCount++;\n        // 记录所有tag\n        tagsOfValidProps.push(tags);\n      }\n    });\n    // 计算 sku 组合数 ,即table row\n    if (validPropsCount > 0) {\n      skuTableRowCount = tagsOfValidProps.reduce((pre, item) => {\n        return pre * item.length;\n      }, 1);\n    }\n\n    // 生成 sku\n    let skuTableDataSource = [];\n    for (let rowIndex = 0; rowIndex < skuTableRowCount; rowIndex++) {\n      let obj = {\n        id: rowIndex,\n        isOld: false,\n        tagList: []\n      };\n      let rowTags = [];\n      for (let col = 0; col < validPropsCount; col++) {\n        // 生成 sku tag 组合 在表格中位置\n        let tagsOfSingleProp = tagsOfValidProps[col],\n          tagsLength = tagsOfSingleProp.length,\n          otherCombinedLength = 1;\n        for (let i = 0; i <= col; i++) {\n          otherCombinedLength *= tagsOfValidProps[i].length;\n        }\n        let tagIndex =\n          parseInt(rowIndex / (skuTableRowCount / otherCombinedLength)) %\n          tagsLength;\n        let singleTag = tagsOfSingleProp[tagIndex];\n        // 标记或恢复 tag 的所有属性\n\n        obj[`validPropColumn_${col}`] = singleTag[\"tagName\"];\n        obj.tagList.push(singleTag);\n        rowTags.push(singleTag);\n      }\n      // 从原数据中查找,有无原sku 数据,并标记 isNew , 恢复原数据\n      let sku = filterSku && filterSku(rowTags);\n      if (sku) {\n        obj.isOld = true;\n        obj = Object.assign(obj, sku);\n      }\n      let tags = rowTags.map(tag => tag.id).sort();\n      let rowKey = tags.join(\"_\");\n      obj = Object.assign(obj, {\n        tags,\n        rowKey\n      });\n\n      skuTableDataSource.push(obj);\n    }\n\n    // 计算 rowSpan 表格合并计算\n    for (let i = 0; i < validPropsCount; i++) {\n      const column = skuTableColumns[i];\n      column.rowSpan = 0;\n      column.render = this._calcSpan(validPropsCount, tagsOfValidProps, i);\n    }\n\n    if (Object.prototype.toString.call(extras) === \"[object Function]\") {\n      skuTableColumns.push(...extras());\n    } else {\n      skuTableColumns.push(...extras);\n    }\n\n    this.setState(\n      {\n        skuTableColumns,\n        skuTableDataSource\n      },\n      () => {\n        onChange({\n          skuTableColumns,\n          skuTableDataSource,\n          tmpSkuProps\n        });\n      }\n    );\n  }\n\n  setCurrentProp(propId, index = false) {\n    const { skuPropsList, tmpSkuProps, tmpSkuColumns, editProp } = this.state;\n    let label = skuPropsList.filter(i => i.id === propId)[0].propertyName;\n    if (index === false) {\n      index = editProp.index;\n      this.props.form.setFieldsValue({\n        [editProp.key]: propId\n      });\n    }\n    tmpSkuProps[index].id = propId;\n    tmpSkuProps[index].propertyName = label;\n    tmpSkuProps[index].tags = [];\n    // 变更表格表头列\n    tmpSkuColumns[index] = {\n      title: label,\n      dataIndex: `validPropColumn_${index}`\n    };\n    this.setState(\n      {\n        tmpSkuProps,\n        tmpSkuColumns\n      },\n      () => {\n        this.refreshSKUTable();\n      }\n    );\n  }\n\n  _initData() {\n    const { tmpSkuColumns, tmpSkuProps, skuPropVoList = [] } = this.state;\n    //\n    let skuData = skuPropVoList;\n    if (skuData.length === 0) return;\n\n    skuData.map((item, i) => {\n      let propertyName = item.propertyName;\n      let obj = {\n        key: `key_${item.id}`,\n        saveInputRef: React.createRef(),\n        tags: [],\n        //\n        id: item.id,\n        propertyName\n      };\n\n      tmpSkuColumns.push({\n        title: propertyName,\n        dataIndex: `validPropColumn_${i}`\n      });\n      tmpSkuProps.push(obj);\n\n      item.tagList.map(tag => {\n        obj.tags.push({\n          id: tag.id,\n          propertyId: item.id,\n          propertyName,\n          tagName: tag.tagName\n        });\n        return tag;\n      });\n      return item;\n    });\n\n    this.setState(\n      {\n        tmpSkuColumns,\n        tmpSkuProps,\n        needInit: false\n      },\n      () => {\n        this.refreshSKUTable();\n      }\n    );\n  }\n\n  _calcSpan(validPropsCount, tagsOfValidProps, i) {\n    return (v, row, index) => {\n      let len = 1;\n      for (let y = i + 1; y < validPropsCount; ++y) {\n        let tags = tagsOfValidProps[y];\n        len *= tags.length;\n      }\n\n      let rowSpan = 0;\n      if (index % len === 0) {\n        rowSpan = len;\n      }\n\n      return {\n        children: v,\n        props: {\n          rowSpan\n        }\n      };\n    };\n  }\n\n  _handleInputConfirm(e, index, tmpSkuProps) {\n    const { addTagApi } = this.props;\n    let singleProp = tmpSkuProps[index];\n    let tagName = singleProp.saveInputRef.current.input.value.trim();\n    if (tagName && singleProp.id) {\n      let isExits = singleProp.tags.some(tag => {\n        return tag.tagName === tagName;\n      });\n      if (isExits) {\n        singleProp.inputTagVisible = false;\n        message.error(\"已添加\");\n        this.setState({\n          tmpSkuProps\n        });\n      } else {\n        addTagApi(singleProp, tagName).then(res => {\n          if (res.status) {\n            let entry = res.entry;\n            singleProp.tags.push({\n              id: entry.id,\n              propertyId: singleProp.id,\n              propertyName: singleProp.propertyName,\n              tagName: tagName\n            });\n          }\n\n          singleProp.inputTagVisible = false;\n\n          this.setState(\n            {\n              tmpSkuProps\n            },\n            () => {\n              this.refreshSKUTable();\n            }\n          );\n        });\n      }\n    } else {\n      message.error(\"不能为空\");\n      singleProp.inputTagVisible = false;\n\n      this.setState({\n        tmpSkuProps\n      });\n    }\n  }\n\n  _renderProps(singleProp, index, getFieldDecorator) {\n    const { skuPropsList, tmpSkuProps, tmpSkuColumns } = this.state;\n    return (\n      <div key={`id_${singleProp.key}`}>\n        <Row>\n          <Col span={8}>\n            <FormItem>\n              <div\n                onMouseDown={e => {\n                  e.preventDefault();\n                  return false;\n                }}\n              >\n                {getFieldDecorator(singleProp.key, {\n                  initialValue: singleProp.id,\n                  rules: [{ required: true, message: \"必填属性或删除\" }]\n                })(\n                  <Select\n                    style={{ width: \"100%\" }}\n                    placeholder=\"请选择属性\"\n                    optionFilterProp=\"children\"\n                    showSearch={true}\n                    onChange={v => {\n                      this.setCurrentProp(v, index, true);\n                    }}\n                    dropdownRender={menu => (\n                      <div\n                        onClick={() => {\n                          return false;\n                        }}\n                      >\n                        {menu}\n                        <Divider style={{ margin: \"4px 0\" }} />\n                        <div\n                          style={{ padding: \"8px\", cursor: \"pointer\" }}\n                          onClick={e => {\n                            this.setState(\n                              {\n                                editProp: {\n                                  index,\n                                  key: singleProp.key\n                                }\n                              },\n                              () => {\n                                this.props.addProp && this.props.addProp(index);\n                              }\n                            );\n                            return false;\n                          }}\n                        >\n                          <Icon type=\"plus\" /> 新增\n                      </div>\n                      </div>\n                    )}\n                  >\n                    {skuPropsList.map(prop => (\n                      <Select.Option\n                        value={prop.id}\n                        key={`${prop.id}_${prop.propertyName}`}\n                        disabled={tmpSkuProps.some(item => item.id === prop.id)}\n                      >\n                        {prop.propertyName}\n                      </Select.Option>\n                    ))}\n                  </Select>\n                )}\n              </div>\n            </FormItem>\n          </Col>\n          <Col span={1}>\n            <Icon\n              type=\"close-circle\"\n              theme=\"twoTone\"\n              twoToneColor=\"red\"\n              onClick={() => {\n                let v = tmpSkuProps[index].id;\n                let list = skuPropsList.filter(i => i.id === v);\n                let label = list.length > 0 ? list[0].propertyName : \"-\";\n                Modal.confirm({\n                  title: \"删除属性\",\n                  content: `是否确认删除属性: ${label}`,\n                  okText: \"确认\",\n                  cancelText: \"取消\",\n                  onOk: () => {\n                    tmpSkuProps.splice(index, 1);\n                    tmpSkuColumns.splice(index, 1);\n                    this.setState(\n                      {\n                        tmpSkuProps,\n                        tmpSkuColumns\n                      },\n                      () => {\n                        this.refreshSKUTable();\n                      }\n                    );\n                  }\n                });\n              }}\n              style={{ fontSize: 24, margin: 8 }}\n            />\n          </Col>\n        </Row>\n        <Row>\n          {singleProp.tags.map((tag, i) => {\n            return (\n              <Tag\n                key={`item_${index}_tag_${tag.id}`}\n                closable={true}\n                onClose={() => {\n                  tmpSkuProps[index].tags.splice(i, 1);\n                  this.setState(\n                    {\n                      tmpSkuProps\n                    },\n                    () => {\n                      // 计算 sku 表格\n                      this.refreshSKUTable();\n                    }\n                  );\n                }}\n              >\n                {tag.tagName}\n              </Tag>\n            );\n          })}\n          {singleProp.inputTagVisible ? (\n            <Input\n              ref={singleProp.saveInputRef}\n              type=\"text\"\n              size=\"small\"\n              style={{ width: 78 }}\n              onChange={this.handleInputChange}\n              onBlur={e => this._handleInputConfirm(e, index, tmpSkuProps)}\n              onPressEnter={e =>\n                this._handleInputConfirm(e, index, tmpSkuProps)\n              }\n            />\n          ) : (\n              <Tag\n                onClick={() => {\n                  singleProp.inputTagVisible = true;\n                  this.setState({\n                    tmpSkuProps\n                  });\n                }}\n                style={{ background: \"#fff\", borderStyle: \"dashed\" }}\n              >\n                <Icon type=\"plus\" />\n                添加\n            </Tag>\n            )}\n        </Row>\n      </div>\n    );\n  }\n\n  _renderSkuTable() {\n    const { skuTableDataSource, skuTableColumns, tmpSkuProps } = this.state;\n    return tmpSkuProps.length > 0 ? (\n      <Table\n        dataSource={skuTableDataSource}\n        rowKey=\"id\"\n        columns={[...skuTableColumns]}\n        bordered\n        pagination={false}\n        scroll={{ x: \"max-content\" }}\n        title={this.props.title}\n        footer={this.props.footer}\n      />\n    ) : null;\n  }\n\n  render() {\n    const { tmpSkuProps } = this.state;\n    const { form, useDefaultButton = true, formItemLayout = {\n      labelCol: {\n        span: 6\n      },\n      wrapperCol: {\n        span: 18\n      }\n    },\n      label1 = '',\n      label2 = '',\n    } = this.props;\n    const { getFieldDecorator } = form;\n    return (\n      <div>\n        <FormItem label={label1} {...formItemLayout}>\n          {tmpSkuProps.map((item, index) =>\n            this._renderProps(item, index, getFieldDecorator)\n          )}\n          {useDefaultButton && (\n            <Button\n              disabled={this.state.disabled}\n              onClick={() => {\n                this.addOneProp();\n              }}\n              style={{ margin: \"10px 0\" }}\n            >\n              添加属性\n            </Button>\n          )}\n        </FormItem>\n\n        <FormItem label={label2} {...formItemLayout}>{this._renderSkuTable()}</FormItem>\n      </div>\n    );\n  }\n}\n"],"names":["pSlice","Array","prototype","slice","Object_keys","Object","keys","obj","key","push","deepEqual","actual","expected","areZerosEqual","Date","getTime","isNumberNaN","objEquiv","isUndefinedOrNull","value","undefined","isArguments","object","toString","call","zeroA","zeroB","a","b","ka","kb","i","e","length","sort","FormItem","Item","props","state","disabled","skuPropsList","skuPropVoList","setState","_initData","nextProps","prevState","update","needInit","assign","deepCompare","tmpSkuColumns","tmpSkuProps","React","createRef","extras","onChange","filterSku","tagsOfValidProps","validPropsCount","skuTableColumns","skuTableRowCount","forEach","sku","tags","reduce","pre","item","skuTableDataSource","rowIndex","rowTags","col","tagsOfSingleProp","tagsLength","otherCombinedLength","tagIndex","parseInt","singleTag","tagList","isOld","map","tag","id","rowKey","join","column","rowSpan","render","_calcSpan","propId","index","editProp","label","filter","propertyName","form","setFieldsValue","refreshSKUTable","skuData","tagName","v","row","len","y","addTagApi","singleProp","saveInputRef","current","input","trim","isExits","some","inputTagVisible","error","then","res","status","entry","getFieldDecorator","preventDefault","required","message","width","setCurrentProp","margin","padding","cursor","addProp","prop","list","confirm","splice","fontSize","handleInputChange","_handleInputConfirm","background","borderStyle","x","title","footer","useDefaultButton","formItemLayout","label1","label2","_renderProps","addOneProp","_renderSkuTable","Component"],"mappings":"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"}